#!/bin/bash

docker network create rebase-labs

docker run \
  --rm \
  -d \
  --name pgserver \
  -e POSTGRES_USER=docker -e POSTGRES_PASSWORD=docker -e POSTGRES_DB=rebaselabs \
  -v $(pwd)/pgdata:/var/lib/postgresql/data \
  --network rebase-labs \
  postgres \

docker run \
  --rm \
  --name rebase-labs \
  -w /app \
  -v $(pwd):/app \
  -v labs-gems:/usr/local/bundle \
  -p 3000:3000 \
  --network rebase-labs \
  ruby \
  bash -c "bundle install && ruby server.rb"

docker stop pgserver